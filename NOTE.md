# Web 製作者のための CSS 設計の教科書

『Web 製作者のための CSS 設計の教科書』のメモ。

"壊れない完璧な設計を求めるのではなく、壊れたときに勇気を持って修復できる設計を" 斉藤祐也

# 目次

- CSS の設計とは
- CSS の基本
- コンポーネント設計のアイデア
  - OOCSS
  - SMACSS
  - BEM
  - MCSS
  - FLOCSS
- コンポーネント設計の実践
- CSS プリプロセッサ
- コンポーネントの運用
  - スタイルガイド
- Web Components

5 min

# 1 CSS における設計とは

## 1-1 CSS 設計の重要性

- ぼくの気になる点は CSS における設定がなぜ重要でなぜ必要なのか。

- デザインをブラウザで表現するだけではない
- 運用の中でたくさんの人がメンテナンスする
- コンテンツが増える
- キャンペーンやリニューアルなどで変更する
- 後任者 (あるいは 1 ヶ月後の自分)が困らないように

5 min

- メンテナンスがしやすいように
- HTML5 の登場など Web サイトの複雑化

- ぼくとしてはソフトウェアの品質特性と同じようなものを確保するために必要。
  - http://www15.ocn.ne.jp/~squality/software-quality/iso9126.htm
- いきあたりばったりだと破綻しやすい (経験則)

5 min


- ゴール
  - 予測しやすい
    - 保守性 解析性
    - 保守性 安定性 デグレードもここに含んでいるようで
  - 再利用しやすい
    - 保守性 安定性 再利用に
    - 保守性 変更性 再利用しやすければ変更にかかる労力を減らせる
    - 移植性 設置性 (コンポーネント単位でみたときの評価？)
  - 保守しやすい
    - 保守性 解析性
    - 保守性 変更性
    - 保守性 安定性
  - 拡張しやすい
    - 保守性 変更性
    - 保守性 安定性

- 保守性 解析性 保守の範囲特定をしやすいか
- 保守性 変更性 追加をしやすいか
- 保守性 安定性 デグレードしやすいか
- 保守性 試験性 テストしやすいか

まとめると

- 保守性をたかめるためにルールを決めましょう (なんだか説得力にかけるけど……)


5 min

## 1-2 破綻しやすい CSS

- CSS は宣言的な言語。
- `.selector { property: value }` というフォーマットを覚えれば書ける。
- 書くだけなら簡単だが容易に破綻する。
  - ？どうして？
- 理由: HTML の構造に依存している
  - セレクタの書きかたにもよるが HTML の構造が変わると破綻する。
  - HTML で class を指定しておきセレクタには class を使うと良い。

5 min

- 理由: スタイルを取り消している
  - 打ち消すルールとクラスを追加する→無駄な行が増える
  - 追加するルールとクラスにしておくほうが良い
    - 個人的には CSS の打ち消すがまずいというよりはルール間の相互干渉が分かりづらいと破綻しやすい気がする。
- 理由: 絶対値を多用している
  - line-height に絶対値を指定している
    - 個人的には line-height の例は適切でないと思う。
    - line-height の数値指定が何を表すのかを理解しているのは前提
    - font-size に合わせて line-height を変えるべきとは限らない
    - line-height を抽出して継承を前提とすることは HTML の構造への依存度を高めている。
      - .introduction .lead な HTML 構造を前提条件として追加してしまっている。
- 理由: モダンなサイト構築ワークフロー
  - 反復的なワークフローの場合に手戻りを減らす

あれ、なんか途中から「破綻の理由」じゃなくなっているような。

個人的には CSS が破綻しやすいのは、HTML 構造への依存、継承の仕組みなどによる影響範囲の特定の難しさにあると思っている。 #hitoridokusho

まとめるとぼくの思う破綻の理由は

- HTML 構造の変更が CSS のセレクタから外れる原因に直結する。
- 親要素からの継承や class などにより意図しないルールが適用される。
- そして事前の設計やルール化がされていないと上記の問題が発生しやすくなる。

5 min

# 2 CSS の基本を振り返る

## 2-1 CSS セレクタと詳細度

- カスケーディング(継承)の話
- 詳細度の話
  - !important
  - style=""
  - id="id" / #id
  - class="class" / .class
  - attr="value" / [attr="value"]
  - :first-child
  - element
  - ::after
  - *

まとめると

- 新しい話はない。復習。
- CSS 設計上は抑えておかないと話にならない。

## 2-2 セレクタのリファクタリング

- ？装飾を維持しながら詳細度を下げることをリファクタリングと呼んでいる？
- 要素セレクタを省略する
- セレクタを短くする (子孫セレクタの中間を削除する)
- セレクタを限定的にする (子セレクタを使う)
- クラスセレクタを活用する

結局一番大きいのはクラスセレクタをどう活用するか、かな。 CSS 設計は同時に HTML 設計でもある。コンポーネント設計と呼ばれることが多いのかな。

まとめると

- 余計な指定で詳細度を上げるな。
  - 上書きがしづらくなるなど問題が多い。
- 重要なのはクラスセレクタをどう活用するか。
- CSS 設計は HTML 設計であり、コンポーネント設計である、とぼくは感じる。

5 min

# 3 コンポーネント設計のアイデア

## 3-1 CSS におけるコンポーネント設計

- コンポーネントの説明
- 関心の分離 (separation of concerns)
  - 機能や振る舞いなどを明確に分離をする
- ？ぼくはそこまでの意味では使っていなくて「部品」とかあるいは何かの「単位」を指しているかな。
- カプセル化
  - ？なんだか怪しい説明文だ……
  - コンポーネント間で相互に変更の影響が出ないようにする……という意味で挙げているのかな。
  - で、これは CSS には備わっていない、と。
  - ID セレクタでくくっても意味がないよという話
    - #news .title {} が .title {} の影響を受ける例
- 既存のコンポーネント設計のためのアプローチを見ていく。

- コンポーネントの説明としてはあんまり良くない気がする。
- ぼくは「部品」やひとまとまりになっている「単位」程度の意味で良いと思う。
- カプセル化の問題は 1-2 の破綻の理由に加えるべきかも。
  - 予期せぬルールが適用されてしまう→変更の影響範囲をつかみにくい。
  - 設計なしに class を付与すると予期せぬルールが適用されてしまう可能性がある

5 min

各章まとめ追記

5 min

まとめると

- 2-2 と重複するけどコンポーネント設計が要る。
- CSS の保守性 (意図しないルールの適用を防ぐなど) のために。

## 3-2 OOCSS

- OOCSS : Object Oriented CSS
- OOCSS の原則
  - 構造と見た目の分離
  - コンテナーとコンテンツとを分離
- 構造と見た目の分離
  - .alert と .success / .warning / .error とを分離させる。
  - 基本的な構造 (?) は変わらないのでそれを .alert に、文字色などの見た目をその他に。
- クラスセレクタを使っていく
- 要素セレクタは HTML 構造への依存を強くするので使わない
  - ？要素セレクタを使うということは子孫セレクタを使うということ
  - ？子孫セレクタは詳細度が上がっていく
- ID セレクタは再利用のために使わない
  - 著者は基本的には割けるが一意だと明らかなものには使う。
  - 詳細度の観点でも問題がある。

5 min

- コンテナーとコンテンツとを分離
  - 場所に依存しないセレクタを書く
- class を追加することで場所に依存する ルールを追加する
  - `class="logo logo-small"`

まとめると

- OOCSS は「構造と見た目の分離」と「コンテナとコンテンツ」との分離を意識する。
- OOCSS はクラスの再利用を前提としている。
- OOCSS はマルチクラス設計。
- OOCSS はおそらく子孫セレクタよりもクラスを複数組み合わせることで対応することを良しとしている。
- クラスセレクタを使う。
- 要素セレクタを使わない。
  - HTML 構造への依存が強まるため。
  - 子孫セレクタが前提になり詳細度が上がるため。
  - 影響範囲が HTML 構造次第になるため。
- ID セレクタを使わない。
  - 再利用のため。
  - 詳細度が上がるため。

5 min
